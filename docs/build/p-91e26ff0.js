import{S as t,a as s,O as i,s as e,i as r}from"./p-8e815e86.js";class n extends t{constructor(t,s){super()}schedule(t,s=0){return this}}class h{constructor(t,s=h.now){this.SchedulerAction=t,this.now=s}schedule(t,s=0,i){return new this.SchedulerAction(this,t).schedule(i,s)}}h.now=()=>Date.now();class u extends h{constructor(t,s=h.now){super(t,(()=>u.delegate&&u.delegate!==this?u.delegate.now():s())),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,s=0,i){return u.delegate&&u.delegate!==this?u.delegate.schedule(t,s,i):super.schedule(t,s,i)}flush(t){const{actions:s}=this;if(this.active)return void s.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=s.shift());if(this.active=!1,i){for(;t=s.shift();)t.unsubscribe();throw i}}}function c(t){return t&&"function"==typeof t.schedule}const o=new u(class extends n{constructor(t,s){super(t,s),this.scheduler=t,this.work=s,this.pending=!1}schedule(t,s=0){if(this.closed)return this;this.state=t;const i=this.id,e=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(e,i,s)),this.pending=!0,this.delay=s,this.id=this.id||this.requestAsyncId(e,this.id,s),this}requestAsyncId(t,s,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,s,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return s;clearInterval(s)}execute(t,s){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,s);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,s){let i,e=!1;try{this.work(t)}catch(t){e=!0,i=!!t&&t||new Error(t)}if(e)return this.unsubscribe(),i}_unsubscribe(){const t=this.id,s=this.scheduler,i=s.actions,e=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==e&&i.splice(e,1),null!=t&&(this.id=this.recycleAsyncId(s,t,null)),this.delay=null}});class l extends s{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends s{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function f(t,s){if(!s.closed)return t instanceof i?t.subscribe(s):e(t)(s)}function d(t){return!r(t)&&t-parseFloat(t)+1>=0}function p(t=0,s,e){let r=-1;return d(s)?r=Number(s)<1?1:Number(s):c(s)&&(e=s),c(e)||(e=o),new i((s=>{const i=d(t)?t:+t-e.now();return e.schedule(x,i,{index:0,period:r,subscriber:s})}))}function x(t){const{index:s,period:i,subscriber:e}=t;if(e.next(s),!e.closed){if(-1===i)return e.complete();t.index=s+1,this.schedule(t,i)}}function w(t){return function(s){const i=new b(t),e=s.lift(i);return i.caught=e}}class b{constructor(t){this.selector=t}call(t,s){return s.subscribe(new y(t,this.selector,this.caught))}}class y extends a{constructor(t,s,i){super(t),this.selector=s,this.caught=i}error(t){if(!this.isStopped){let s;try{s=this.selector(t,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const i=new l(this);this.add(i);const e=f(s,i);e!==i&&this.add(e)}}}export{a as S,l as a,w as c,f as i,p as t}